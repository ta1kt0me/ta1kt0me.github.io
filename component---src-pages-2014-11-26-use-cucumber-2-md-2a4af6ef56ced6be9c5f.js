(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{Bl7J:function(e,t,n){"use strict";var a=n("dwav"),r=n("q1tI"),b=n.n(r),l=n("Wbzz"),c=function(e){var t=e.siteTitle;return b.a.createElement("header",{style:{background:"white",marginBottom:"1.45rem"}},b.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"1.45rem 1.0875rem"}},b.a.createElement("h1",{style:{margin:0}},b.a.createElement(l.Link,{to:"/",style:{color:"black",textDecoration:"none"}},t))))};c.defaultProps={siteTitle:""};var i=c;n("8ypT"),t.a=function(e){var t=e.children,n=a.data;return b.a.createElement(b.a.Fragment,null,b.a.createElement(i,{siteTitle:n.site.siteMetadata.title}),b.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"0 1.0875rem 1.45rem"}},b.a.createElement("main",null,t),b.a.createElement("footer",null,"© ",(new Date).getFullYear(),", Built with"," ",b.a.createElement("a",{href:"https://www.gatsbyjs.org"},"Gatsby"),"by ",n.site.siteMetadata.author)))}},"ag2/":function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return b})),n.d(t,"default",(function(){return i}));n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("91GP"),n("q1tI");var a=n("7ljp"),r=n("Bl7J");var b={},l={_frontmatter:b},c=r.a;function i(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,r={},b=Object.keys(e);for(a=0;a<b.length;a++)n=b[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,["components"]);return Object(a.b)(c,Object.assign({},l,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"に引き続き簡単なCucumberのテストケースを作ります。"),Object(a.b)("p",null,"サンプルソースはこちらです。",Object(a.b)("br",{parentName:"p"}),"\n",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/ta1kt0me/cucumber-test/tree/forth-test"}),"ta1kt0me/cucumber-test")),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",Object.assign({parentName:"tr"},{align:"center"}),"ライブラリ"),Object(a.b)("th",Object.assign({parentName:"tr"},{align:"center"}),"バージョン"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:"center"}),"ruby"),Object(a.b)("td",Object.assign({parentName:"tr"},{align:"center"}),"2.1.5")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:"center"}),"rails"),Object(a.b)("td",Object.assign({parentName:"tr"},{align:"center"}),"4.1.5")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:"center"}),"cucumber"),Object(a.b)("td",Object.assign({parentName:"tr"},{align:"center"}),"1.3.17")))),Object(a.b)("h1",null,"今回やること"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},Object(a.b)("inlineCode",{parentName:"li"},"given"),"を使う"),Object(a.b)("li",{parentName:"ol"},Object(a.b)("inlineCode",{parentName:"li"},"and"),"を使う"),Object(a.b)("li",{parentName:"ol"},Object(a.b)("inlineCode",{parentName:"li"},"background"),"を使う"),Object(a.b)("li",{parentName:"ol"},"1つのシナリオにWhen-Thenを複数回書く")),Object(a.b)("h1",null,"given"),Object(a.b)("p",null,"givenを利用して、テストデータの投入を行います。",Object(a.b)("br",{parentName:"p"}),"\n","Factory Girl使います。"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"Gemfile",Gemfile:!0}),"group :test do\n  gem 'cucumber-rails', require: false\n  gem 'database_cleaner'\n  gem 'factory_girl_rails' # 追加\nend\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{}),"$ bundle\n$ bundle exec rails g factory_girl:model Book title:string author:string price:integer\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/home_page.feature","features/home_page.feature":!0}),"  ...\n  Scenario: Viwing application's home page\n    # 追加\n    Given there's a book titled 'Alice\\'s Adventures in Wonderland' with 'Lewis Carroll' author, '1000' yen\n    When I am on the top page\n    ...\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/step_definitions/home_page_steps.rb","features/step_definitions/home_page_steps.rb":!0}),"# 追加\nGiven(/^there's a book titled '(.*?)' with '(.*?)' author, '(\\d+)' yen$/) do |title, author, price|\n  @book = FactoryGirl.create(:book, title: title, author: author, price: price)\nend\n...\n")),Object(a.b)("p",null,"(自分用メモ:改善点)",Object(a.b)("br",{parentName:"p"}),"\n","シングルクォートで囲まないでもいいかも。",Object(a.b)("br",{parentName:"p"}),"\n","テストケース内で利用しない限りあえてインスタンス変数にする必要もないなー。  "),Object(a.b)("h1",null,"and"),Object(a.b)("p",null,"続いてand。これは簡単です。  "),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/home_page.feature","features/home_page.feature":!0}),"    ...\n    Then I should see the 'Listing books'\n    And  I should see the 'Alice\\&#39;s Adventures in Wonderland'\n")),Object(a.b)("p",null,"応用きくやつです。"),Object(a.b)("h1",null,"background"),Object(a.b)("p",null,"シナリオの前に複雑な操作や処理をしたい場合に有効です。",Object(a.b)("br",{parentName:"p"}),"\n","Bookの作成ページをテストするシナリオの前段として、トップページを表示する操作をbackgroundで書いてみます。",Object(a.b)("br",{parentName:"p"}),"\n","なお、このシナリオではリンク・ボタン操作やフィールド入力をするので、便利なcapybara-webkitを導入します。  "),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb"}),"group :test do\n  gem 'cucumber-rails', require: false\n  gem 'database_cleaner'\n  gem 'factory_girl_rails'\n  gem 'capybara-webkit' # 追加\nend\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{}),"$ bundle\n")),Object(a.b)("p",null,"新しいシナリオ、new_page.featureを作ります。"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/new_page.feature","features/new_page.feature":!0}),"Feature: New Page\n\n  Background:\n    Given I go to the top page\n\n  Scenario: Adding New Book\n    When I click 'New Book' link\n    Then I should see the 'New book'\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/step_definitions/new_page_steps.rb","features/step_definitions/new_page_steps.rb":!0}),"Given(/^I go to the top page$/) do\n  visit root_path\nend\n\nWhen(/^I click '(.*?)' link$/) do |link_name|\n  click_link(link_name)\nend\n")),Object(a.b)("h1",null,"1つのシナリオにWhen-Thenを複数回書く"),Object(a.b)("p",null,"new_page.featureを完成させましょう。"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"'New Book'リンクを押したら、'New Book'タイトルが表示される"),Object(a.b)("li",{parentName:"ol"},"'Title','Author','Price'を入力して、'Create Book'ボタンを押したら、'Book was successfully created.'というメッセージと入力した内容が表示される")),Object(a.b)("p",null,"というシナリオを作ります。"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/new_page.feature","features/new_page.feature":!0}),"  ...\n  Scenario: Adding New Book\n    When I click 'New Book' link\n    Then I should see the 'New book'\n    When I fill in 'Title' with 'Star Wars'\n    And I fill in 'Author' with 'George Walton Lucas, Jr'\n    And I fill in 'Price' with '2980'\n    And I click 'Create Book' button\n    Then I should see the 'Book was successfully created.'\n    And I should see the 'Star Wars'\n    And I should see the 'George Walton Lucas, Jr'\n    And I should see the '2980'\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb",metastring:"features/step_definitions/new_page_steps.rb","features/step_definitions/new_page_steps.rb":!0}),"...\nWhen(/^I click '(.*?)' button$/) do |button_name|\n  click_button(button_name)\nend\n\nWhen(/^I fill in '(.*?)' with '(.*?)'$/) do |field, value|\n  fill_in(field, with: value)\nend\n")),Object(a.b)("p",null,"capybara-webkitですが、",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://gist.github.com/zhengjia/428105"}),"チートシート"),"があるので有効活用しましょう。"),Object(a.b)("p",null,"stepsで定義した操作は共通化してあげると良いですね。"))}i.isMDXComponent=!0},dwav:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"title":"jangajan.com","author":"@ta1kt0me"}}}}')}}]);
//# sourceMappingURL=component---src-pages-2014-11-26-use-cucumber-2-md-2a4af6ef56ced6be9c5f.js.map