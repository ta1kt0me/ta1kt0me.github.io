<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Blog | JanGaJan.com]]></title>
  <link href="http://jangajan.com/blog/categories/blog/atom.xml" rel="self"/>
  <link href="http://jangajan.com/"/>
  <updated>2014-11-16T22:51:00+09:00</updated>
  <id>http://jangajan.com/</id>
  <author>
    <name><![CDATA[talkto_me]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[独自ドメイン設定]]></title>
    <link href="http://jangajan.com/blog/2014/05/08/get-original-domain/"/>
    <updated>2014-05-08T00:00:00+09:00</updated>
    <id>http://jangajan.com/blog/2014/05/08/get-original-domain</id>
    <content type="html"><![CDATA[<h1>独自ドメイン設定の道程</h1>

<p>せっかくなので独自ドメインでも設定してみよう。<br/>
そうすれば否が応でも書かずにはいられないはず。<br/>
有料だもの。現金な人間です。</p>

<p>手順としてはこんな感じでした。</p>

<!-- more -->


<ol>
<li>独自ドメイン取得(お名前.com)</li>
<li>cloudflareで独自ドメインとherokuを紐付け</li>
<li>herokuに独自ドメイン設定</li>
<li>おまけ:google analyticsの設定</li>
</ol>


<hr />

<h1>独自ドメイン取得</h1>

<p>お名前.comで独自ドメイン購入。<br/>
最近は.tokyoやら.redやらあるんですね。<br/>
.comにしました。<br/>
あらかじめ候補探しておきましょう。<br/>
大体は使われています。
悩んでいると日が暮れます。</p>

<hr />

<h1>cloudflare独自ドメインとheroku連携</h1>

<p>wwwつけると入力手間だな〜っていう理由でルートドメインはしたくない。<br/>
たまたま<a href="http://blog.jnito.com/entry/2014/05/04/090537">こちらの記事</a>を見かけまして。<br/>
cloudflareを利用することにしました。<br/>
用途はブログを公開するだけだし、SSL利用するまでもなかったので無料プランで試してみました。<br/>
使い切れてないですが、設定だけでもできたの良し。目的達成。<br/>
設定完了後、whoisコマンドのName Serverの値がcloudflare用に変わります。<br/>
反映されるのに待ちます。</p>

<hr />

<h1>herokuに独自ドメイン設定</h1>

<p>herokuアプリのSettingsのDomainsに独自ドメインを追加。<br/>
これしないと、herokuの404画面が出てくる。</p>

<hr />

<h1>google analyticsの設定</h1>

<p>トラッキング情報のトラッキングコードを<em>google-analytics.htmlにコピペ。<br/>
</em>config.ymlを以下の通り変更
<code>yaml
  analytics:
+    google: false
+    google: true</code></p>

<p>夜明けに寝て夕暮れ時に目覚めても反映されてませんでした。<br/>
気長に待ちましょう。</p>

<p>どれも長い。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Jekyllでブログを作ってみた]]></title>
    <link href="http://jangajan.com/blog/2014/04/20/setup-jekyll-blog/"/>
    <updated>2014-04-20T00:00:00+09:00</updated>
    <id>http://jangajan.com/blog/2014/04/20/setup-jekyll-blog</id>
    <content type="html"><![CDATA[<p>JekyllとHerokuを使ってBlogを作成しました。<br/>
サーバーにはUnicornを利用します。<br/>
githubはprivate repositoryが有料なので、bitbucketを使用。<br/>
せっかくなのでCIツールとして、werckerをお試しで。<br/>
よくよく考えるとHeroku使うんならどっちも要らないがさておき。</p>

<!-- more -->


<hr />

<h1>事前準備</h1>

<h2>アカウント作成</h2>

<ol>
<li>heroku</li>
<li>bitbucket(ついでにrepositoryも作成)</li>
<li>wercker</li>
</ol>


<h1>jekyllインストール</h1>

<p>jekyllのgemをインストールします。<br/>
テンプレートとして、<a href="https://github.com/kippt/jekyll-incorporated.git">jekyll-incorporated</a>を使ってみます。<br/>
なかなかいい感じにデザインしてくれる。</p>

<p><div class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;gem install jekyll
git clone &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://github.com/kippt/jekyll-incorporated.git&quot;</span>&gt;https://github.com/kippt/jekyll-incorporated.git&lt;/a&gt; blog
<span class="nb">cd </span>blog
git branch myblog
git checkout myblog</code></pre></div></p></blockquote>

<hr />

<h1>環境設定</h1>

<p>環境用のファイルを作成。<br/>
heroku、wercker用の設定ファイルと、jekyllのmarkdownの設定をします。</p>

<p><div class="highlight"><pre><code class="language-text" data-lang="text">blog
├── Gemfile      # 必要なGemを追加
├── Gemfile.lock
├── Procfile     # heroku用
├── _config.yml
├── config.ru    # heroku用
├── unicorn.rb   # heroku用
&amp;hellip;
└── wercker.yml  # wercker用</code></pre></div></p>

<h2>Gemfile</h2>

<p><div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">+</span> <span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">rack</span><span class="o">-</span><span class="n">jekyll</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
<span class="o">+</span> <span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">unicorn</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span></code></pre></div></p>

<h2>Procfile</h2>

<p><div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">+</span> <span class="ss">web</span><span class="p">:</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">unicorn</span> <span class="o">-</span><span class="nb">p</span> <span class="vg">$PORT</span> <span class="o">-</span><span class="n">c</span> <span class="o">.</span><span class="n">/unicorn</span><span class="o">.</span><span class="n">rb</span></code></pre></div></p>

<h2>_config.yml</h2>

<pre><code class="yaml">- exclude:     []
+ exclude:     ["vendor"]
- markdown:      maruku
+ markdown:      redcarpet
+ redcarpet:
+     extensions: ["no_intra_emphasis"
+                  ,"fenced_code_blocks"
+                  ,"autolink"
+                  ,"tables"
+                  ,"with_toc_data"]
</code></pre>

<h2>config.ru</h2>

<pre><code class="ruby">+ require "bundler/setup"
+ Bundler.require(:default)
+ run Rack::Jekyll.new(:destination =&gt; '_site')
</code></pre>

<h2>unicorn.rb</h2>

<pre><code class="ruby">+ worker_processes 1
+ timeout 30
+ preload_app true
</code></pre>

<h2>wercker.yml</h2>

<p>indentは半角スペース2つじゃないと怒られる。<br/>
<a href="http://devcenter.wercker.com/articles/werckeryml/validate.html">ここ</a>でフォーマットのチェックができて便利ですね。</p>

<p><div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">+ box</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">wercker/ruby</span>
<span class="l-Scalar-Plain">+ build</span><span class="p-Indicator">:</span>
<span class="l-Scalar-Plain">+   steps</span><span class="p-Indicator">:</span>
<span class="l-Scalar-Plain">+     - bundle-install</span>
<span class="l-Scalar-Plain">+     - script</span><span class="p-Indicator">:</span>
<span class="l-Scalar-Plain">+         name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">echo ruby information</span>
<span class="l-Scalar-Plain">+         code</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
<span class="l-Scalar-Plain">+             echo &amp;ldquo;ruby version $(ruby &amp;ndash;version) running!&amp;rdquo;</span>
<span class="l-Scalar-Plain">+             echo &amp;ldquo;from location $(which ruby)&amp;rdquo;</span>
<span class="l-Scalar-Plain">+             echo -p &amp;ldquo;gem list</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">$(gem list)&amp;rdquo;</span>
<span class="l-Scalar-Plain">+ deploy</span><span class="p-Indicator">:</span>
<span class="l-Scalar-Plain">+   steps</span><span class="p-Indicator">:</span>
<span class="l-Scalar-Plain">+   - heroku-deploy</span></code></pre></div></p>

<hr />

<h1>Remote Repositoryにpush</h1>

<p>ここまでの設定を保存します。
実際はちまちまコミットしちゃいました。<br/>
ついでにherokuでアプリ作成。</p>

<p><div class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;bundle install
git remote add bitbucket git@bitbucket.org:xxxx/jekyllblog.git
git add .
git commit -m <span class="p">&amp;</span>lsquo<span class="p">;</span>initial commit <span class="k">for</span> myblog<span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/p&gt;

&lt;h1&gt;bitbucketにpush&lt;/h1&gt;

&lt;p&gt;git push bitbucket myblog&lt;/p&gt;

&lt;h1&gt;herokuに専用アプリ作成&lt;/h1&gt;

&lt;p&gt;heroku create myblog</code></pre></div></p></blockquote>

<p>ちなみに、ここでherokuにpushして、<code>heroku open</code>すれば確認できる。<br/>
やっぱりこっちの方が楽なんじゃ&hellip;</p>

<hr />

<h1>wercker</h1>

<p>いよいよwercker試してみます。</p>

<h2>Add App</h2>

<p>ここでは作業対象となるリポジトリを設定します。<br/>
(<a href="https://app.wercker.com/#applications/create">ADD APPLICATION</a>)</p>

<h3>Choose a Git provider</h3>

<p><em>bitbucket</em>を選択</p>

<h3>Select a repository</h3>

<p>pushしたbranchを選択</p>

<h3>Add werckerbot</h3>

<p><em>read</em>権限だけつけて許可する</p>

<h3>Setup your wercker.yml</h3>

<p>準備済み！</p>

<h2>My Apps</h2>

<p>Add Appで登録したAppsを選択します。</p>

<h3>Settings</h3>

<p><em>Deploy targets</em>でHeroku APIキーの登録します。<br/>
<em>Deploy target name</em>にheroku createしたアプリ名を設定します。</p>

<h3>Builds</h3>

<p>Build Passが通ったら、<em>Deploy to</em>から<strong>Settings</strong>に設定したアプリ名を選択します。</p>

<hr />

<h1>動作確認</h1>

<p>成功していればDeploysのデプロイ結果のURLからアクセス可能です。
(あるいは<code>heroku open</code>)</p>
]]></content>
  </entry>
  
</feed>
