(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{Bl7J:function(e,t,n){"use strict";var a=n("dwav"),r=n("q1tI"),i=n.n(r),l=n("Wbzz"),s=function(e){var t=e.siteTitle;return i.a.createElement("header",{style:{background:"white",marginBottom:"1.45rem"}},i.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"1.45rem 1.0875rem"}},i.a.createElement("h1",{style:{margin:0}},i.a.createElement(l.Link,{to:"/",style:{color:"black",textDecoration:"none"}},t))))};s.defaultProps={siteTitle:""};var c=s;n("8ypT"),t.a=function(e){var t=e.children,n=a.data;return i.a.createElement(i.a.Fragment,null,i.a.createElement(c,{siteTitle:n.site.siteMetadata.title}),i.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"0 1.0875rem 1.45rem"}},i.a.createElement("main",null,t),i.a.createElement("footer",null,"© ",(new Date).getFullYear(),", Built with"," ",i.a.createElement("a",{href:"https://www.gatsbyjs.org"},"Gatsby"),"by ",n.site.siteMetadata.author)))}},dwav:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"title":"jangajan.com","author":"@ta1kt0me"}}}}')},jIUw:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return i})),n.d(t,"default",(function(){return c}));n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("91GP"),n("q1tI");var a=n("7ljp"),r=n("Bl7J");var i={},l={_frontmatter:i},s=r.a;function c(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,["components"]);return Object(a.b)(s,Object.assign({},l,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"AOJの0009で素数の数を計算する問題。パフォーマンスがうまく解決できなかった。"),Object(a.b)("p",null,Object(a.b)("a",Object.assign({parentName:"p"},{href:"http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0009"}),"http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0009")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"2以外の偶数は探索対象としない"),Object(a.b)("li",{parentName:"ul"},"最大値の平方根より大きい値は探索対象としない")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb"}),"max = 199_999\nres = (5..max).to_a.delete_if(&:even?).each_with_object([2, 3]) do |e, a|\n  limit = Math.sqrt(e).round\n  lst = a.take_while { |i| i < limit }\n  a.push e unless lst.any? { |i| e % i == 0 }\nend\nputs res.count\n")),Object(a.b)("p",null,"結果はあってるけど、タイムアウトした..."),Object(a.b)("p",null,Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://www.wikiwand.com/ja/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9"}),"エラトステネスの篩"),"をやってみた。"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb"}),"max = 199_999\nlst = (2..max).to_a\nresult = []\nsqrt = Math.sqrt(max)\n\nloop do\n  elem = lst.shift\n  result << elem\n  break if elem >= sqrt\n  lst.delete_if { |i| i % elem == 0 }\nend\n\nputs (result + lst).count\n")),Object(a.b)("p",null,"これでもタイムアウト..."),Object(a.b)("p",null,Object(a.b)("a",Object.assign({parentName:"p"},{href:"http://docs.ruby-lang.org/ja/2.3.0/library/prime.html"}),"Prime"),"という素数を扱うライブラリがあったので使ってみる。"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb"}),"require 'prime'\nmax = 199_999\nPrime.each(max).count\n")),Object(a.b)("p",null,"せっかくなのでbenchmark-ipsで計測。"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-rb"}),"require 'benchmark/ips'\n\nBenchmark.ips do |x|\n  def calc\n    max = 199_999\n    res = (5..max).to_a.delete_if(&:even?).each_with_object([2, 3]) do |e, a|\n      limit = Math.sqrt(e).round\n      lst = a.take_while { |i| i < limit }\n      a.push e unless lst.any? { |i| e % i == 0 }\n    end\n    res.count\n  end\n\n  def eratostenes\n    max = 199_999\n    lst = (2..max).to_a\n    result = []\n    sqrt = Math.sqrt(max)\n\n    loop do\n      elem = lst.shift\n      result << elem\n      break if elem >= sqrt\n      lst.delete_if { |i| i % elem == 0 }\n    end\n\n    (result + lst).count\n  end\n\n  def prime\n    require 'prime'\n    max = 199_999\n    Prime.each(max).count\n  end\n\n  x.config(time: 10, warmup: 2)\n  x.report('calc') { calc }\n  x.report('eratostenes') { eratostenes }\n  x.report('prime') { prime }\n  x.compare!\nend\n\nWarming up --------------------------------------\n                calc     1.000  i/100ms\n         eratostenes     1.000  i/100ms\n               prime    21.000  i/100ms\nCalculating -------------------------------------\n                calc      0.596  (± 0.0%) i/s -      6.000\n         eratostenes      4.838  (±20.7%) i/s -     46.000\n               prime    195.376  (±21.5%) i/s -      1.848k\n\nComparison:\n               prime:      195.4 i/s\n         eratostenes:        4.8 i/s - 40.39x slower\n                calc:        0.6 i/s - 327.62x slower\n")),Object(a.b)("p",null,"Prime早い...エラトステネスの篩も最初のやり方に比べたらかなり早いですね。Primeどうやっているんだろう。"))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-2016-03-18-prime-number-md-31a0c9565029fdb62087.js.map